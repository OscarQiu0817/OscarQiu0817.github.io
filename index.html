<!DOCTYPE html>
<html>
<head>
    <title>QR Code Scanner</title>
	<script src="./index.min.js" ></script>
	<style>
* {
  box-sizing: border-box;
}
.menu {
  float: left;
  width: 20%;
}
.menuitem {
  padding: 8px;
  margin-top: 7px;
  border-bottom: 1px solid #f1f1f1;
}
.main {
  float: left;
  width: 60%;
  padding: 0 20px;
  overflow: hidden;
}
.right {
  background-color: lightblue;
  float: left;
  width: 20%;
  padding: 10px 15px;
  margin-top: 7px;
}

@media only screen and (max-width:800px) {
  /* For tablets: */
  .main {
    width: 80%;
    padding: 0;
  }
  .right {
    width: 100%;
  }
}
@media only screen and (max-width:500px) {
  /* For mobile phones: */
  .menu, .main, .right {
    width: 100%;
  }
}
</style>
</head>
<body>
    <h1>QR Code Scanner</h1>
    <video id="videoElement" width="700" height="500" autoplay></video>
    <br>
    <input type="text" id="qrResult" placeholder="Scanned QR Code will appear here" readonly>
    
    <script>
        // 获取视频元素
        var video = document.getElementById('videoElement');
        // 尝试获取用户媒体设备
        navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } })
        .then(function(stream) {
            // 将视频流绑定到视频元素
            video.srcObject = stream;
        })
        .catch(function(err) {
            console.log("An error occurred: " + err);
        });

        // 使用ZXing库解析扫描的QR码
        const codeReader = new ZXing.BrowserQRCodeReader();
        codeReader.getVideoInputDevices()
        .then(videoInputDevices => {
            codeReader.decodeFromVideoDevice(videoInputDevices[0].deviceId, 'videoElement', (result, err) => {
                if (result) {
                    // 将解码结果显示在输入框中
                    document.getElementById('qrResult').value = result.text;
                }
                if (err && !(err instanceof ZXing.NotFoundException)) {
                    console.error(err);
                    document.getElementById('qrResult').value = "Error occurred while scanning QR code. Please try again.";
                }
            });
        })
        .catch(err => {
            console.error(err);
            document.getElementById('qrResult').value = "Error occurred while accessing camera. Please make sure your device supports camera access and try again.";
        });
		
		
		
		
    </script>
</body>
</html>
